(()=>{var e={};e.id=332,e.ids=[220,332,636],e.modules={237:(e,t)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},361:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},1413:(e,t)=>{"use strict";Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},2015:e=>{"use strict";e.exports=require("react")},2326:e=>{"use strict";e.exports=require("react-dom")},2768:()=>{},3656:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d,getServerSideProps:()=>l});let a=require("next-auth/next"),s=require("next-auth");var n=r.n(s);let i=require("next-auth/providers/credentials");var o=r.n(i);let u=[{id:"1",username:"nino.marquet",password:"1",name:"Nino Marquet",email:"nino.marquet@stirweld.com",image:"/photo_user/Ninomarquet.jpg"},{id:"2",username:"anthony.trouve",password:"2",name:"Anthony Trouv\xe9",email:"anthony.trouve@stirweld.com",image:"/photo_user/Anthonytrouv\xe9.jpg"},{id:"3",username:"dominique.dubourg",password:"3",name:"Dominique Dubourg",email:"dominique.dubourg@stirweld.com",image:"/photo_user/Dominiquedubourg.jpg"},{id:"4",username:"gabin.dubourg",password:"4",name:"Gabin Dubourg",email:"gabin.dubourg@stirweld.com",image:"/photo_user/Gabindubourg.jpg"},{id:"5",username:"gabin.vigor",password:"leplusbeau",name:"Gabin Vigor",email:"gabin.vigor@stirweld.com",image:"/photo_user/Gabinvigor.jpg"},{id:"5",username:"admin",password:"12345",name:"admin",email:"admin",image:"/photo_user/Ninomarquet.JPG"}],c={session:{strategy:"jwt"},providers:[o()({name:"Credentials",credentials:{username:{label:"Utilisateur",type:"text"},password:{label:"Mot de passe",type:"password"}},async authorize(e){let t=u.find(t=>t.username===e.username&&t.password===e.password);return t?{id:t.id,name:t.name,email:t.email,image:t.image}:null}}),function(e){return{id:"asana",name:"Asana",type:"oauth",version:"2.0",scope:"default",params:{grant_type:"authorization_code"},authorization:{url:"https://app.asana.com/-/oauth_authorize",params:{response_type:"code"}},token:"https://app.asana.com/-/oauth_token",userinfo:"https://app.asana.com/api/1.0/users/me",clientId:e.clientId,clientSecret:e.clientSecret,async profile(e){let t=e.data;return{id:t.gid,name:t.name,email:t.email||null,image:t.photo?.image_60x60||null}},...e}}({clientId:process.env.ASANA_CLIENT_ID,clientSecret:process.env.ASANA_CLIENT_SECRET})],callbacks:{jwt:async({token:e,user:t,account:r})=>(t&&!r||r?.provider==="asana"&&r.access_token&&(e.asanaAccessToken=r.access_token),e),session:async({session:e,token:t})=>(t.name&&(e.user.name=t.name),t.email&&(e.user.email=t.email),t.image&&(e.user.image=t.image),t.asanaAccessToken&&(e.user.asanaAccessToken=t.asanaAccessToken),e)},pages:{signIn:"/login"},secret:process.env.NEXTAUTH_SECRET};async function l(e){return await (0,a.getServerSession)(e.req,e.res,c)?{redirect:{destination:"/dashboard",permanent:!1}}:{redirect:{destination:"/login",permanent:!1}}}function d(){return null}n()(c)},3873:e=>{"use strict";e.exports=require("path")},4075:e=>{"use strict";e.exports=require("zlib")},4078:e=>{"use strict";e.exports=import("swr")},4722:e=>{"use strict";e.exports=require("next-auth/react")},5280:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>g});var s=r(8732);r(2768);var n=r(2015),i=r(4722),o=r(9918),u=r.n(o),c=r(4233),l=r(7665),d=r(9875),m=e([d]);function p(){let{data:e}=(0,i.useSession)(),t=(0,c.useRouter)(),r=(0,d.A)(),a="/login"===t.pathname,[o,m]=(0,n.useState)(!1),p=e?.user?.image||null,g=e?.user?.name||"";return(0,s.jsxs)("header",{className:"flex items-center justify-between bg-gray-100 p-4 shadow",children:[(0,s.jsx)(u(),{href:"/",children:(0,s.jsx)("img",{src:"/logo_stirweld.png",alt:"Logo Stirweld",className:"h-20 w-auto cursor-pointer"})}),!a&&(0,s.jsxs)("nav",{className:"flex items-center gap-6",children:[(0,s.jsx)(u(),{href:"/stock",className:"text-gray-700 hover:text-gray-900",children:"Stock"}),(0,s.jsx)(u(),{href:"/commandes",className:"text-gray-700 hover:text-gray-900",children:"Commandes"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u(),{href:"/alertes",className:"text-gray-700 hover:text-gray-900",children:"Alertes"}),r>0&&(0,s.jsx)("span",{className:"   absolute -top-3 -right-3   h-5 min-w-[20px] px-1   bg-red-600 text-white text-xs font-semibold   rounded-full flex items-center justify-center   ",children:r})]}),(0,s.jsx)(u(),{href:"/history",className:"text-gray-700 hover:text-gray-900",children:"Historique"}),(0,s.jsx)(u(),{href:"/projects",className:"text-gray-700 hover:text-gray-900",children:"Produits"}),(0,s.jsx)(u(),{href:"/projects-asana",className:"text-gray-700 hover:text-gray-900",children:"Asana"}),e?.user?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 relative",children:[p?(0,s.jsx)("img",{src:p,alt:g,onClick:()=>m(!0),className:"h-10 w-10 rounded-full object-cover cursor-pointer border-2 border-gray-300"}):(0,s.jsx)(l.A,{className:"h-10 w-10 text-gray-400 cursor-pointer",onClick:()=>m(!0)}),(0,s.jsx)("span",{className:"text-gray-800 font-medium text-sm",children:g})]}):(0,s.jsx)(u(),{href:"/login",className:"text-blue-600 hover:underline",children:"Connexion"})]}),o&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg max-w-xs text-center",children:[(0,s.jsx)("p",{className:"mb-4",children:"Voulez-vous vraiment vous d\xe9connecter ?"}),(0,s.jsxs)("div",{className:"flex justify-around",children:[(0,s.jsx)("button",{onClick:()=>{m(!1),(0,i.signOut)({callbackUrl:`${window.location.origin}/login`})},className:"px-4 py-1 bg-red-600 text-white rounded",children:"Oui"}),(0,s.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-1 bg-gray-300 rounded",children:"Non"})]})]})})]})}function g({Component:e,pageProps:{session:t,...r}}){return(0,s.jsxs)(i.SessionProvider,{session:t,children:[(0,s.jsx)(p,{}),(0,s.jsx)("main",{className:"p-4",children:(0,s.jsx)(e,{...r})})]})}d=(m.then?(await m)():m)[0],a()}catch(e){a(e)}})},5385:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>h,getStaticPaths:()=>g,getStaticProps:()=>p,reportWebVitals:()=>b,routeModule:()=>S,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>P,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>f});var s=r(3885),n=r(237),i=r(1413),o=r(9616),u=r.n(o),c=r(5280),l=r(3656),d=e([c]);c=(d.then?(await d)():d)[0];let m=(0,i.M)(l,"default"),p=(0,i.M)(l,"getStaticProps"),g=(0,i.M)(l,"getStaticPaths"),h=(0,i.M)(l,"getServerSideProps"),x=(0,i.M)(l,"config"),b=(0,i.M)(l,"reportWebVitals"),f=(0,i.M)(l,"unstable_getStaticProps"),v=(0,i.M)(l,"unstable_getStaticPaths"),y=(0,i.M)(l,"unstable_getStaticParams"),j=(0,i.M)(l,"unstable_getServerProps"),P=(0,i.M)(l,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:n.A.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},components:{App:c.default,Document:u()},userland:l});a()}catch(e){a(e)}})},7910:e=>{"use strict";e.exports=require("stream")},8732:e=>{"use strict";e.exports=require("react/jsx-runtime")},9021:e=>{"use strict";e.exports=require("fs")},9875:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{A:()=>i});var s=r(4078),n=e([s]);s=(n.then?(await n)():n)[0];let o=e=>fetch(e).then(e=>e.json());function i(){let{data:e,error:t}=(0,s.default)("/api/stock",o);return t||!Array.isArray(e)?0:e.filter(e=>Number(e["Qte stock"]||0)+Number(e["En Commande"]||0)<Number(e["Qte mini"]||0)).length}a()}catch(e){a(e)}})}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[89,172,616],()=>r(5385));module.exports=a})();